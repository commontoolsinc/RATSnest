# Custom IMA policy - measure executables including on tmpfs
# Key: Put measure rules BEFORE dont_measure rules so executables are measured even on tmpfs

# Measure all executables and security-critical operations (works on tmpfs)
measure func=BPRM_CHECK
measure func=MMAP_CHECK mask=MAY_EXEC
measure func=MODULE_CHECK
measure func=FIRMWARE_CHECK
measure func=POLICY_CHECK
measure func=KEXEC_KERNEL_CHECK
measure func=KEXEC_INITRAMFS_CHECK

# Don't measure FILE_CHECK on tmpfs (prevents measuring every temp file)
# This rule only affects FILE_CHECK, not the exec measurements above
dont_measure func=FILE_CHECK fsmagic=0x1021994

# Measure files opened for read by root (on non-tmpfs filesystems)
measure func=FILE_CHECK mask=^MAY_READ euid=0
measure func=FILE_CHECK mask=^MAY_READ uid=0

# Don't measure pseudo filesystems (proc, sysfs, devtmpfs, etc)
dont_measure fsmagic=0x9fa0
dont_measure fsmagic=0x62656572
dont_measure fsmagic=0x64626720
dont_measure fsmagic=0x1cd1
dont_measure fsmagic=0x42494e4d
dont_measure fsmagic=0x73636673
dont_measure fsmagic=0xf97cff8c
dont_measure fsmagic=0x43415d53
dont_measure fsmagic=0x27e0eb
dont_measure fsmagic=0x63677270
dont_measure fsmagic=0x6e736673
dont_measure fsmagic=0xde5e81e4
